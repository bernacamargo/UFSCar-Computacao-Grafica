<html>
	<head>
	  <meta charset=utf-8>
		<title>Atividade II - Computação Gráfica</title>
		
		<!--  Three.js CDN  -->
 	  <script src="../js/three.js"></script>
	  <script src="../js/loader/OBJLoader.js"></script>
	  <script src="../js/OrbitControls.js"></script>  
	  <script src="../js/loader/MTLLoader.js"></script>
	  <style>
		  body { margin: 0; }
		  canvas { width: 100%; height: 100%}

			.info {
				position: absolute;
				top: 10px;
				margin-left: 10px;
				width: 50%;
				z-index: 100;
				display:block;
			}
	  </style>
	</head>

	<body>
		<div class="info">
			<h2>Controles</h2>
			<p>Mover para Frente: &uarr;</p>
			<p>Mover para Trás: &darr;</p>
			<p>Câmera 1: 1</p>
			<p>Câmera 2: 2</p>
		</div>

		<script>	
			// ------------------------------------------------
			// BASIC SETUP
			// ------------------------------------------------
			// Sceane
			var scene = new THREE.Scene();

			// Camera
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 10000);
			camera.lookAt([10, 0, 0]);
			camera.position.set(0, 5, 20);


			// Render
			var renderer = new THREE.WebGLRenderer();
			renderer.setClearColor("#fff");
			renderer.setSize(window.innerWidth, window.innerHeight);

			// Append Renderer to DOM
			document.body.appendChild(renderer.domElement);

			// Controls
			var controls = new THREE.OrbitControls(camera);
			controls.enabled = false;
			controls.update();

			// ------------------------------------------------
			// FUN STARTS HERE
			// ------------------------------------------------
			// Objects
			var lamborghini = null;
			var tree = null;
			

 			//Adiciona eixos
			var axis = new THREE.AxisHelper(10);
			scene.add(axis); 
		  
			// Loader
			var loader = new THREE.OBJLoader();
		  var loader2 = new THREE.OBJLoader();

			// Loader Lamborghini
			loader.load(
			  //URL
				'assets/Car/Car 2014 Lamborghini Huracan LP 610-4 Forza Horizon N290119.obj',
				
			  // Called when loaded
			  function (object) {
					lamborghini = object;
					scene.add(lamborghini);
					var tScale = 1;
					lamborghini.scale['x'] = tScale;
					lamborghini.scale['y'] = tScale;
					lamborghini.scale['z'] = tScale;
					lamborghini.position.set(0, 0, 0);
				},
				
			  // Called while loading
			  function (xhr) {
					console.log( (xhr.loaded / xhr.total * 100 ) + '% loaded' );
				},
				
			  // called when loading has errors
			  function (error) {
					//console.log( 'Error to load Lamborghini object' );
			  }
			);

			// Loader Tree
			loader2.load(
			  //URL
				'assets/Tree/Tree.obj',
				
			  // Called when loaded
				function(object){
					tree = object;
					scene.add(tree);
					var tScale = 1.7;
					tree.scale['x'] = tScale;
					tree.scale['y'] = tScale;
					tree.scale['z'] = tScale;
					tree.position.set(5, 0, 0);
				},
				
			  // Called while loading
				function (xhr) {
					//console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
				},

				// called when loading has errors
				function (error) {
					console.log( 'Error to load tree' );
				}
			);
		  
			// Render Loop
			var animate = function () {
			  requestAnimationFrame(animate);
			  controls.update();

			  // Render the scene
			  renderer.render(scene, camera);
			};
			animate();
			
			window.addEventListener('keydown', onKeyDown, false);
			function onKeyDown(e) {
				var stepPosition = 0.5;

				//Controls
				switch (e.which) {
					//Move car with arrows controls
					case 38:
						lamborghini.position['z'] += stepPosition;
					break;
					case 40:
						lamborghini.position['z'] -= stepPosition;
					break;
					//Change camera
					case 49:
						camera.position.set(0, 5, 20);
					break;
					case 50:
						camera.position.set(10, 10, 10);
					break;
						lamborghini.applyMatrix();
					default:
						console.log(lamborghini.matrix);
					break;
				}
			}
		</script>
	</body>
</html>